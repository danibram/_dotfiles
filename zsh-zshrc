# Path to your oh-my-zsh installation.
export ZSH="$HOME/.zsh/ohmyzsh"
ZSH_CUSTOM="$HOME/.zsh/ohmyzsh-custom"

if [[ -n "$plugins" ]]; then read -A plugins <<< "$plugins"; else
plugins=(
	git
	vscode
	# custom plugins go here
	git-prompt
	k
	async
)
fi

source $ZSH/oh-my-zsh.sh

#########
# PROMPT
ZSH_GIT_PROMPT_SHOW_UPSTREAM="no"
ZSH_THEME_GIT_PROMPT_PREFIX="["
ZSH_THEME_GIT_PROMPT_SUFFIX="] "
ZSH_THEME_GIT_PROMPT_SEPARATOR="|"
ZSH_THEME_GIT_PROMPT_DETACHED="%{$fg_bold[cyan]%}:"
ZSH_THEME_GIT_PROMPT_BRANCH="%{$fg_bold[magenta]%}"
ZSH_THEME_GIT_PROMPT_UPSTREAM_SYMBOL="%{$fg_bold[yellow]%}⟳ "
ZSH_THEME_GIT_PROMPT_UPSTREAM_PREFIX="%{$fg[red]%}(%{$fg[yellow]%}"
ZSH_THEME_GIT_PROMPT_UPSTREAM_SUFFIX="%{$fg[red]%})"
ZSH_THEME_GIT_PROMPT_BEHIND="↓"
ZSH_THEME_GIT_PROMPT_AHEAD="↑"
ZSH_THEME_GIT_PROMPT_UNMERGED="%{$fg[red]%}✖"
ZSH_THEME_GIT_PROMPT_STAGED="%{$fg[green]%}●"
ZSH_THEME_GIT_PROMPT_UNSTAGED="%{$fg[red]%}✚"
ZSH_THEME_GIT_PROMPT_UNTRACKED="…"
ZSH_THEME_GIT_PROMPT_STASHED="%{$fg[blue]%}⚑"
ZSH_THEME_GIT_PROMPT_CLEAN="%{$fg_bold[green]%}✔"

shpwd() {
  echo ${${:-/${(j:/:)${(M)${(s:/:)${(D)PWD:h}}#(|.)[^.]}}/${PWD:t}}//\/~/\~}
}

PROMPT='🐈🐈 $(shpwd)$(gitprompt)'
PROMPT+='%(?.%(!.%F{white}❯.%F{green})❯%f.%F{red}❯%f) '
RPROMPT='%{$fg[yellow]%}[%D{%L:%M:%S}]%{${reset_color}%}'

# Don't load Oh My Zsh on TTYs
[[ $TTY != /dev/tty* || -n "$OMZ_LOAD" ]] && source "$ZSH/oh-my-zsh.sh"

# complete . and .. directories
zstyle ':completion:*' special-dirs true

# paginated completion
zstyle ':completion:*' list-prompt   ''
zstyle ':completion:*' select-prompt ''

## More zsh options

# correction of commands
setopt correct

# extended globbing (adds ^ and other symbols as wildcards)
setopt extended_glob

# i want all typed commands to be available everywhere
setopt share_history

# zmv
autoload zmv
alias mmv='noglob zmv -W -v'

# Docker completion option stacking
zstyle ':completion:*:*:docker:*' option-stacking yes
zstyle ':completion:*:*:docker-*:*' option-stacking yes

#########
# Aliases
[[ -f ~/.zsh/aliases ]] && . ~/.zsh/aliases

# add current directory to the end of PATH
path+=.